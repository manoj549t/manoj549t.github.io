<!doctype html>
<html>
<head>
<title>TW5 - Dropbox</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="css/folder.css">
</head>

<body>

	<div class="modal fade" id="twitsModal" tabindex="-1" role="dsialog" aria-labelledby="twitsModalLabel" aria-hidden="true">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header bg-info">
	        <h5 class="modal-title" id="twitsModalLabel">Dropbox Files</h5>
	        <button type="button" class="btn btn-sm btn btn-outline-light invisible" id="folderUp">
	          <!--<span aria-hidden="true">&times;</span>-->
	          <i class="material-icons">arrow_back</i>
	        </button>
	      </div>
	      <div class="modal-body" id="twitsModalBody">
	        	<!--<div id="twits-files"></div>-->
	        	<ul class="list-group" id="myList"></ul>
	      </div>
	    </div>
	  </div>
	</div>

</body>
</html>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
<script src="js/utils.js" type="text/javascript"></script>

<script type="text/javascript">

var dbxFiles = new Object();

(function LoadInitialData() {
	dbxFiles.firstChildDirectory = [
	{"type": "file", "name": "First Child File - #1"},
	{"type": "file", "name": "First Child File - #2"}
	];

	dbxFiles.firstDirectory = [
	{"type": "folder", "name": "First Child Folder", "directory": dbxFiles.firstChildDirectory},
	{"type": "file", "name": "First File - #1"},
	{"type": "file", "name": "First File - #2"},
	{"type": "file", "name": "First File - #3"}
	];

	dbxFiles.secondDirectory = [
	{"type": "file", "name": "Second File - #1"},
	{"type": "file", "name": "Second File - #2"},
	{"type": "file", "name": "Second File - #2"}
	];

	dbxFiles.topDirectory = [
	{"type": "folder", "name": "First Folder", "directory": dbxFiles.firstDirectory}, 
	{"type": "folder", "name": "Second Folder", "directory": dbxFiles.secondDirectory}, 
	{"type": "file", "name": "First File"}, 
	{"type": "file", "name": "Second File"}, 
	{"type": "file", "name": "Third File"}
	];

	dbxFiles.firstChildDirectory.parent = dbxFiles.firstDirectory;
	dbxFiles.firstDirectory.parent = dbxFiles.topDirectory;
	dbxFiles.secondDirectory.parent = dbxFiles.topDirectory; 
})();


(function InitializeList(directory, objLi) {
	debugger;
	if(!objLi) {
		console.log("Unordered list is expected in the function."); return;
	}

	objLi.empty(); 

	if(directory.parent) {
		document.getElementById("folderUp").classList.remove("invisible");
		document.getElementById("folderUp").classList.add("visible");
		document.getElementById("folderUp").addEventListener("click", InitializeList.bind(this, directory.parent, objLi), false);

	} else {
		document.getElementById("folderUp").classList.remove("visible");
		document.getElementById("folderUp").classList.add("invisible");
	}

	var folderIcon = document.createElement("i");
	folderIcon.classList.add("material-icons");
	folderIcon.style.color = "#3d9ae8";
	folderIcon.appendChild(document.createTextNode("folder"));

	var fileIcon = document.createElement("i");
	fileIcon.classList.add("material-icons");
	fileIcon.style.color = "dimgrey";
	fileIcon.appendChild(document.createTextNode("insert_drive_file"));

	directory.forEach(function(item, index){
		var listItem = document.createElement("a");
		var listName = document.createTextNode(item.name);

		if(item.type == "folder") {
			listItem.appendChild(folderIcon.cloneNode(true));
			listItem.addEventListener("click", InitializeList.bind(this, item.directory, objLi), false);

		} else {
			listItem.appendChild(fileIcon.cloneNode(true));
		}

		listItem.appendChild(listName);
		listItem.classList.add("list-group-item");
		listItem.classList.add("list-group-item-action");

		objLi.append(listItem);
	});

	folderIcon.remove();
	fileIcon.remove();
})(dbxFiles.topDirectory, $("#myList")) ;


$(document).ready(function(){
	$("#twitsModal").modal();
});

</script>